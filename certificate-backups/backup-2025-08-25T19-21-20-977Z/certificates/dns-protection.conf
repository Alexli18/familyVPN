# DNS Leak Protection Configuration
# Generated by Network Security Manager
# Requirement 6.3: Prevent DNS leaks

# Secure DNS servers (Cloudflare)
push "dhcp-option DNS 1.1.1.1"
push "dhcp-option DNS 1.0.0.1"

# Alternative secure DNS servers (Quad9)
# push "dhcp-option DNS 9.9.9.9"
# push "dhcp-option DNS 149.112.112.112"

# Block outside DNS to prevent leaks
push "block-outside-dns"

# Force all DNS queries through VPN
push "dhcp-option DOMAIN-ROUTE ."
push "register-dns"

# Redirect all traffic through VPN (prevents DNS leaks)
push "redirect-gateway def1 bypass-dhcp"

# Additional DNS security measures
push "dhcp-option DOMAIN local"
push "dhcp-option ADAPTER_DOMAIN_SUFFIX local"

# IPv6 DNS leak protection
push "dhcp-option DNS6 2606:4700:4700::1111"
push "dhcp-option DNS6 2606:4700:4700::1001"
