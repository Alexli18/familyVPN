# OpenVPN Hardened Server Configuration
# Generated by VPN Security Hardening System
# Implements security requirements 3.1-3.5

# Basic Server Settings
port 1194
proto udp
dev tun
topology subnet

# Certificate and Key Files
ca /Users/alex/Desktop/privateVPN/test-certificates/ca.crt
cert /Users/alex/Desktop/privateVPN/test-certificates/server.crt
key /Users/alex/Desktop/privateVPN/test-certificates/server.key
dh /Users/alex/Desktop/privateVPN/test-certificates/dh.pem

# TLS Authentication (Requirement 3.2)
tls-crypt /Users/alex/Desktop/privateVPN/test-certificates/ta.key
tls-version-min 1.2
tls-cipher TLS-ECDHE-RSA-WITH-AES-256-GCM-SHA384:TLS-ECDHE-ECDSA-WITH-AES-256-GCM-SHA384:TLS-ECDHE-RSA-WITH-AES-256-CBC-SHA384:TLS-ECDHE-ECDSA-WITH-AES-256-CBC-SHA384

# Strong Encryption (Requirement 3.1)
cipher AES-256-GCM
auth SHA256
ncp-ciphers AES-256-GCM:AES-128-GCM:AES-256-CBC

# Perfect Forward Secrecy (Requirement 3.2)
ecdh-curve prime256v1

# Certificate Verification (Requirement 3.3)
remote-cert-tls client
verify-client-cert require
crl-verify /Users/alex/Desktop/privateVPN/test-certificates/crl.pem

# Network Configuration
server 10.8.0.0 255.255.255.0
push "redirect-gateway def1 bypass-dhcp"

# DNS Configuration and Leak Protection (Requirement 3.4)
push "dhcp-option DNS 1.1.1.1"
push "dhcp-option DNS 1.0.0.1"
push "block-outside-dns"

# Connection Security and Timeouts (Requirement 3.5)
keepalive 10 60
ping-timer-rem
inactive 3600

# Security Hardening
user nobody
group nogroup
persist-key
persist-tun
chroot /var/empty

# Disable compression for security (prevents VORACLE attacks)
compress lz4-v2
push "compress lz4-v2"

# Client connection limits
max-clients 100
duplicate-cn

# Logging and Monitoring (Enhanced)
verb 3
mute 20
status /var/log/openvpn/openvpn-status.log 10
log-append /var/log/openvpn/openvpn.log

# Additional Security Options
script-security 2
# Note: up/down scripts can be configured if needed
# up /Users/alex/Desktop/privateVPN/test-certificates/scripts/up.sh
# down /Users/alex/Desktop/privateVPN/test-certificates/scripts/down.sh

# Prevent DNS leaks and enforce secure DNS
push "dhcp-option DOMAIN-ROUTE ."
push "register-dns"

# Client-specific configurations directory
client-config-dir /Users/alex/Desktop/privateVPN/test-certificates/ccd

# Management interface (localhost only for security)
management 127.0.0.1 7505

# Explicit exit notify
explicit-exit-notify 1
