# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

–≠—Ç–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –æ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –∫–æ–º–ø–ª–µ–∫—Å–Ω—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –¥–ª—è —Å–µ–º–µ–π–Ω–æ–≥–æ VPN-—Å–µ—Ä–≤–µ—Ä–∞, –≤–∫–ª—é—á–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é, —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ, –∫–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞ –∏ —É—Å–∏–ª–µ–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.

## –û–±–∑–æ—Ä

–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–∞ –¥–ª—è –∑–∞—â–∏—Ç—ã –≤–∞—à–µ–≥–æ VPN-—Å–µ—Ä–≤–µ—Ä–∞ –∏ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–π —Ä–∞–±–æ—Ç—ã. –≠—Ç–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –æ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –≤—Å–µ –∞—Å–ø–µ–∫—Ç—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –æ—Ç –±–∞–∑–æ–≤–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –¥–æ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã—Ö —Ç–µ—Ö–Ω–∏–∫ —É—Å–∏–ª–µ–Ω–∏—è –∑–∞—â–∏—Ç—ã.

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

#### –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
```bash
# –ó–∞–ø—É—Å–∫ —Å–∫—Ä–∏–ø—Ç–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
npm run setup-auth

# –≠—Ç–æ –∑–∞–ø—Ä–æ—Å–∏—Ç:
# - –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
# - –ü–∞—Ä–æ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
# - –ì–µ–Ω–µ—Ä–∞—Ü–∏—é –±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö JWT —Å–µ–∫—Ä–µ—Ç–æ–≤
```

#### –†—É—á–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
```env
# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤ —Ñ–∞–π–ª–µ .env
VPN_USERNAME=admin
VPN_PASSWORD_HASH=$2b$12$—Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π.bcrypt.—Ö–µ—à.–∑–¥–µ—Å—å
JWT_SECRET=64-—Å–∏–º–≤–æ–ª—å–Ω–∞—è-hex-—Å—Ç—Ä–æ–∫–∞
JWT_REFRESH_SECRET=64-—Å–∏–º–≤–æ–ª—å–Ω–∞—è-hex-—Å—Ç—Ä–æ–∫–∞
SESSION_SECRET=64-—Å–∏–º–≤–æ–ª—å–Ω–∞—è-hex-—Å—Ç—Ä–æ–∫–∞
```

#### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ö–µ—à–∞ –ø–∞—Ä–æ–ª—è –≤—Ä—É—á–Ω—É—é
```bash
# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è bcrypt —Ö–µ—à–∞ –¥–ª—è –ø–∞—Ä–æ–ª—è
node -e "
const bcrypt = require('bcrypt');
const password = '–≤–∞—à-–±–µ–∑–æ–ø–∞—Å–Ω—ã–π-–ø–∞—Ä–æ–ª—å';
const hash = bcrypt.hashSync(password, 12);
console.log('–•–µ—à –ø–∞—Ä–æ–ª—è:', hash);
"
```

#### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è JWT —Å–µ–∫—Ä–µ—Ç–æ–≤
```bash
# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö —Å–µ–∫—Ä–µ—Ç–æ–≤
node -e "
const crypto = require('crypto');
console.log('JWT_SECRET=' + crypto.randomBytes(32).toString('hex'));
console.log('JWT_REFRESH_SECRET=' + crypto.randomBytes(32).toString('hex'));
console.log('SESSION_SECRET=' + crypto.randomBytes(32).toString('hex'));
"
```

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è JWT —Ç–æ–∫–µ–Ω–æ–≤

#### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ç–æ–∫–µ–Ω–æ–≤
```env
# –í—Ä–µ–º—è –∏—Å—Ç–µ—á–µ–Ω–∏—è JWT —Ç–æ–∫–µ–Ω–æ–≤
JWT_EXPIRY=15m              # –¢–æ–∫–µ–Ω –¥–æ—Å—Ç—É–ø–∞ (15 –º–∏–Ω—É—Ç)
JWT_REFRESH_EXPIRY=7d       # Refresh —Ç–æ–∫–µ–Ω (7 –¥–Ω–µ–π)

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Ç–æ–∫–µ–Ω–æ–≤
ENFORCE_IP_VALIDATION=true  # –ü—Ä–∏–≤—è–∑–∫–∞ —Ç–æ–∫–µ–Ω–æ–≤ –∫ IP –∞–¥—Ä–µ—Å–∞–º
JWT_ISSUER=family-vpn-server
JWT_AUDIENCE=vpn-clients
```

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —Å–µ—Å—Å–∏–π

#### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–µ—Å—Å–∏–π
```env
# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —Å–µ—Å—Å–∏–π
SESSION_SECRET=64-—Å–∏–º–≤–æ–ª—å–Ω–∞—è-hex-—Å—Ç—Ä–æ–∫–∞
SESSION_TIMEOUT=1800000     # 30 –º–∏–Ω—É—Ç –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö
SESSION_SECURE=true         # –¢—Ä–µ–±–æ–≤–∞—Ç—å HTTPS –¥–ª—è cookies
SESSION_HTTP_ONLY=true      # –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ XSS –∞—Ç–∞–∫
SESSION_SAME_SITE=strict    # –ó–∞—â–∏—Ç–∞ –æ—Ç CSRF
```

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç—Ä–æ–ª—è –¥–æ—Å—Ç—É–ø–∞

### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ –∑–∞–ø—Ä–æ—Å–æ–≤

#### –ë–∞–∑–æ–≤–æ–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏
```env
# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Å–∫–æ—Ä–æ—Å—Ç–∏
RATE_LIMIT_WINDOW=15        # –û–∫–Ω–æ –≤ –º–∏–Ω—É—Ç–∞—Ö
RATE_LIMIT_MAX=100          # –ú–∞–∫—Å–∏–º—É–º –∑–∞–ø—Ä–æ—Å–æ–≤ –∑–∞ –æ–∫–Ω–æ
RATE_LIMIT_SKIP_SUCCESS=false # –°—á–∏—Ç–∞—Ç—å —É—Å–ø–µ—à–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã

# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∑–∞–º–µ–¥–ª–µ–Ω–∏—è
SLOW_DOWN_THRESHOLD=50      # –ó–∞–ø—Ä–æ—Å—ã –¥–æ –∑–∞–º–µ–¥–ª–µ–Ω–∏—è
SLOW_DOWN_DELAY=500         # –ò–Ω–∫—Ä–µ–º–µ–Ω—Ç –∑–∞–¥–µ—Ä–∂–∫–∏ –≤ –º—Å
SLOW_DOWN_MAX_DELAY=20000   # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –≤ –º—Å
```

### –ó–∞—â–∏—Ç–∞ –æ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –∞–∫–∫–∞—É–Ω—Ç–∞

#### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
```env
# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –∞–∫–∫–∞—É–Ω—Ç–∞
MAX_FAILED_ATTEMPTS=5       # –ù–µ—É–¥–∞—á–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏ –¥–æ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
LOCKOUT_DURATION=900000     # –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ (15 –º–∏–Ω—É—Ç)
LOCKOUT_INCREMENT=true      # –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –Ω–µ—É–¥–∞—á–∞—Ö
```

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è OpenVPN

#### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–∏–ª—å–Ω–æ–≥–æ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
```conf
# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ OpenVPN (openvpn.conf)

# –®–∏—Ñ—Ä —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è AES-256-GCM)
cipher AES-256-GCM
data-ciphers AES-256-GCM:AES-128-GCM:AES-256-CBC

# –î–∞–π–¥–∂–µ—Å—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
auth SHA256

# –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å TLS
tls-version-min 1.2
tls-cipher TLS-ECDHE-RSA-WITH-AES-256-GCM-SHA384:TLS-ECDHE-ECDSA-WITH-AES-256-GCM-SHA384

# Perfect Forward Secrecy
tls-crypt ta.key

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤
remote-cert-tls client
verify-client-cert require

# –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
reneg-sec 3600
```

#### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤
```env
# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤
CERT_KEY_SIZE=2048          # –†–∞–∑–º–µ—Ä RSA –∫–ª—é—á–∞ (–º–∏–Ω–∏–º—É–º 2048, 4096 –¥–ª—è –≤—ã—Å–æ–∫–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏)
CERT_VALIDITY_DAYS=365      # –ü–µ—Ä–∏–æ–¥ –¥–µ–π—Å—Ç–≤–∏—è —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞
CERT_DIGEST=sha256          # –î–∞–π–¥–∂–µ—Å—Ç –ø–æ–¥–ø–∏—Å–∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ü–µ–Ω—Ç—Ä–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
CA_KEY_SIZE=4096            # –†–∞–∑–º–µ—Ä –∫–ª—é—á–∞ CA (–≤—ã—Å–æ–∫–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –¥–ª—è CA)
CA_VALIDITY_DAYS=3650       # –î–µ–π—Å—Ç–≤–∏–µ CA (10 –ª–µ—Ç)
```

## –£—Å–∏–ª–µ–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### –ó–∞–≥–æ–ª–æ–≤–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

#### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
```javascript
// src/middleware/security-headers.js
const helmet = require('helmet');

const securityHeaders = helmet({
  contentSecurityPolicy: {
    directives: {
      defaultSrc: ["'self'"],
      styleSrc: ["'self'", "'unsafe-inline'"],
      scriptSrc: ["'self'"],
      imgSrc: ["'self'", "data:", "https:"],
      connectSrc: ["'self'"],
      fontSrc: ["'self'"],
      objectSrc: ["'none'"],
      mediaSrc: ["'self'"],
      frameSrc: ["'none'"]
    }
  },
  crossOriginEmbedderPolicy: false,
  hsts: {
    maxAge: 31536000,
    includeSubDomains: true,
    preload: true
  }
});
```

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã

#### –ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π –¥–ª—è —Ñ–∞–π–ª–æ–≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
chmod 600 .env
chmod 600 certificates/*.key
chmod 644 certificates/*.crt
chmod 755 certificates/

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤–ª–∞–¥–µ–ª—å—Ü–∞
chown -R vpnuser:vpnuser /path/to/vpn/server
```

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –±—Ä–∞–Ω–¥–º–∞—É—ç—Ä–∞

### –ü—Ä–∞–≤–∏–ª–∞ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –±—Ä–∞–Ω–¥–º–∞—É—ç—Ä–∞

#### UFW (Ubuntu/Debian)
```bash
# –°–±—Ä–æ—Å –±—Ä–∞–Ω–¥–º–∞—É—ç—Ä–∞
sudo ufw --force reset

# –ü–æ–ª–∏—Ç–∏–∫–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
sudo ufw default deny incoming
sudo ufw default allow outgoing

# –†–∞–∑—Ä–µ—à–∏—Ç—å SSH (–Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–æ—Ä—Ç –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏)
sudo ufw allow ssh

# –†–∞–∑—Ä–µ—à–∏—Ç—å OpenVPN
sudo ufw allow 1194/udp

# –†–∞–∑—Ä–µ—à–∏—Ç—å –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (–æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å –¥–ª—è –∞–¥–º–∏–Ω—Å–∫–∏—Ö IP)
sudo ufw allow from –í–ê–®_–ê–î–ú–ò–ù–°–ö–ò–ô_IP to any port 3000

# –í–∫–ª—é—á–∏—Ç—å –±—Ä–∞–Ω–¥–º–∞—É—ç—Ä
sudo ufw enable

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
sudo ufw status verbose
```

#### –ü—Ä–∞–≤–∏–ª–∞ iptables
```bash
# –û—á–∏—Å—Ç–∫–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø—Ä–∞–≤–∏–ª
sudo iptables -F
sudo iptables -X
sudo iptables -t nat -F
sudo iptables -t nat -X

# –ü–æ–ª–∏—Ç–∏–∫–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
sudo iptables -P INPUT DROP
sudo iptables -P FORWARD DROP
sudo iptables -P OUTPUT ACCEPT

# –†–∞–∑—Ä–µ—à–∏—Ç—å loopback
sudo iptables -A INPUT -i lo -j ACCEPT

# –†–∞–∑—Ä–µ—à–∏—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
sudo iptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT

# –†–∞–∑—Ä–µ—à–∏—Ç—å SSH
sudo iptables -A INPUT -p tcp --dport 22 -j ACCEPT

# –†–∞–∑—Ä–µ—à–∏—Ç—å OpenVPN
sudo iptables -A INPUT -p udp --dport 1194 -j ACCEPT

# –†–∞–∑—Ä–µ—à–∏—Ç—å –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å –∞–¥–º–∏–Ω—Å–∫–æ–≥–æ IP
sudo iptables -A INPUT -p tcp --dport 3000 -s –í–ê–®_–ê–î–ú–ò–ù–°–ö–ò–ô_IP -j ACCEPT

# NAT –¥–ª—è VPN –∫–ª–∏–µ–Ω—Ç–æ–≤
sudo iptables -t nat -A POSTROUTING -s 10.8.0.0/24 -o eth0 -j MASQUERADE

# –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–∞–≤–∏–ª–∞
sudo iptables-save > /etc/iptables/rules.v4
```

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

#### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ª–æ–≥–≥–µ—Ä–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
```javascript
// src/services/security-logger.js
const winston = require('winston');

const securityLogger = winston.createLogger({
  level: 'info',
  format: winston.format.combine(
    winston.format.timestamp(),
    winston.format.json()
  ),
  transports: [
    new winston.transports.File({
      filename: 'logs/security.log',
      level: 'info'
    }),
    new winston.transports.File({
      filename: 'logs/security-error.log',
      level: 'error'
    })
  ]
});

// –¢–∏–ø—ã —Å–æ–±—ã—Ç–∏–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
const SecurityEvents = {
  LOGIN_SUCCESS: 'login_success',
  LOGIN_FAILURE: 'login_failure',
  ACCOUNT_LOCKED: 'account_locked',
  CERT_GENERATED: 'certificate_generated',
  CERT_REVOKED: 'certificate_revoked',
  CONFIG_CHANGED: 'configuration_changed',
  SUSPICIOUS_ACTIVITY: 'suspicious_activity'
};
```

## –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –∞—É–¥–∏—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

#### –°–∫—Ä–∏–ø—Ç —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
```bash
#!/bin/bash
# scripts/security-scan.sh

echo "üîç –ó–∞–ø—É—Å–∫ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏..."

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π —Ñ–∞–π–ª–æ–≤
echo "–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π —Ñ–∞–π–ª–æ–≤..."
find . -name "*.key" -not -perm 600 -exec echo "‚ùå –ù–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã–π —Ñ–∞–π–ª –∫–ª—é—á–∞: {}" \;
find . -name ".env" -not -perm 600 -exec echo "‚ùå –ù–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã–π —Ñ–∞–π–ª .env: {}" \;

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä–æ–ª–µ–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
echo "–ü—Ä–æ–≤–µ—Ä–∫–∞ —É—á–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é..."
if grep -q "admin:admin" .env 2>/dev/null; then
  echo "‚ùå –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é"
fi

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å—Ç–µ—á–µ–Ω–∏—è —Å—Ä–æ–∫–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤
echo "–ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å—Ç–µ—á–µ–Ω–∏—è —Å—Ä–æ–∫–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤..."
for cert in certificates/*.crt; do
  if [ -f "$cert" ]; then
    expiry=$(openssl x509 -enddate -noout -in "$cert" | cut -d= -f2)
    expiry_epoch=$(date -d "$expiry" +%s)
    current_epoch=$(date +%s)
    days_left=$(( (expiry_epoch - current_epoch) / 86400 ))
    
    if [ $days_left -lt 30 ]; then
      echo "‚ö†Ô∏è  –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç $cert –∏—Å—Ç–µ–∫–∞–µ—Ç —á–µ—Ä–µ–∑ $days_left –¥–Ω–µ–π"
    fi
  fi
done

echo "‚úÖ –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–æ"
```

## –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –ø–∞—Ä–æ–ª–µ–π
```bash
# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–∞–¥–µ–∂–Ω—ã—Ö –ø–∞—Ä–æ–ª–µ–π
openssl rand -base64 32

# –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ø–æ–ª–∏—Ç–∏–∫–∏ –ø–∞—Ä–æ–ª–µ–π
# –ú–∏–Ω–∏–º—É–º 12 —Å–∏–º–≤–æ–ª–æ–≤, —Å–º–µ—à–∞–Ω–Ω—ã–π —Ä–µ–≥–∏—Å—Ç—Ä, —Ü–∏—Ñ—Ä—ã, —Å–∏–º–≤–æ–ª—ã
```

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤
```bash
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –Ω–∞–¥–µ–∂–Ω—ã—Ö —Ä–∞–∑–º–µ—Ä–æ–≤ –∫–ª—é—á–µ–π
CERT_KEY_SIZE=4096  # –î–ª—è –≤—ã—Å–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö —Å—Ä–µ–¥

# –†–µ–≥—É–ª—è—Ä–Ω–∞—è —Ä–æ—Ç–∞—Ü–∏—è —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤
# –†–æ—Ç–∞—Ü–∏—è —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ –µ–∂–µ–≥–æ–¥–Ω–æ –∏–ª–∏ —Ä–∞–∑ –≤ –ø–æ–ª–≥–æ–¥–∞

# –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤
chmod 600 certificates/*.key
```

### –°–µ—Ç–µ–≤–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
```bash
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –ø–æ—Ä—Ç–æ–≤ (–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —á–µ—Ä–µ–∑ –Ω–µ—è—Å–Ω–æ—Å—Ç—å)
VPN_PORT=1195
API_PORT=8443

# –í–Ω–µ–¥—Ä–µ–Ω–∏–µ fail2ban –¥–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∑–∞—â–∏—Ç—ã
sudo apt install fail2ban
```

## –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### –û–±—â–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

#### –ü—Ä–æ–±–ª–µ–º—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ö–µ—à–∞ –ø–∞—Ä–æ–ª—è
node -e "
const bcrypt = require('bcrypt');
console.log(bcrypt.compareSync('–≤–∞—à-–ø–∞—Ä–æ–ª—å', process.env.VPN_PASSWORD_HASH));
"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ JWT —Å–µ–∫—Ä–µ—Ç–æ–≤
node -e "
require('dotenv').config();
console.log('–î–ª–∏–Ω–∞ JWT —Å–µ–∫—Ä–µ—Ç–∞:', process.env.JWT_SECRET?.length);
"
```

#### –ü—Ä–æ–±–ª–µ–º—ã —Å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞–º–∏
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞
openssl x509 -in certificates/server.crt -text -noout

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ø–æ—á–∫–∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤
openssl verify -CAfile certificates/ca.crt certificates/server.crt
```

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:

1. **[–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–µ—Ç–∏](networking.md)** - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ç–∏ –∏ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏
2. **[–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤](certificates.md)** - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ PKI –∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤
3. **[–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞](../troubleshooting/diagnostics.md)** - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ –æ–ø–æ–≤–µ—â–µ–Ω–∏–π

<!-- auto-added placeholders to match EN structure -->

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ä–∞–∑–¥–µ–ª (–∑–∞–≥–ª—É—à–∫–∞ 1)


## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ä–∞–∑–¥–µ–ª (–∑–∞–≥–ª—É—à–∫–∞ 2)


## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ä–∞–∑–¥–µ–ª (–∑–∞–≥–ª—É—à–∫–∞ 3)


## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ä–∞–∑–¥–µ–ª (–∑–∞–≥–ª—É—à–∫–∞ 4)


## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ä–∞–∑–¥–µ–ª (–∑–∞–≥–ª—É—à–∫–∞ 5)


## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ä–∞–∑–¥–µ–ª (–∑–∞–≥–ª—É—à–∫–∞ 6)


## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ä–∞–∑–¥–µ–ª (–∑–∞–≥–ª—É—à–∫–∞ 7)


## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ä–∞–∑–¥–µ–ª (–∑–∞–≥–ª—É—à–∫–∞ 8)


## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ä–∞–∑–¥–µ–ª (–∑–∞–≥–ª—É—à–∫–∞ 9)


## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ä–∞–∑–¥–µ–ª (–∑–∞–≥–ª—É—à–∫–∞ 10)


## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ä–∞–∑–¥–µ–ª (–∑–∞–≥–ª—É—à–∫–∞ 11)


## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ä–∞–∑–¥–µ–ª (–∑–∞–≥–ª—É—à–∫–∞ 12)


## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ä–∞–∑–¥–µ–ª (–∑–∞–≥–ª—É—à–∫–∞ 13)


## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ä–∞–∑–¥–µ–ª (–∑–∞–≥–ª—É—à–∫–∞ 14)


## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ä–∞–∑–¥–µ–ª (–∑–∞–≥–ª—É—à–∫–∞ 15)


## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ä–∞–∑–¥–µ–ª (–∑–∞–≥–ª—É—à–∫–∞ 16)


## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ä–∞–∑–¥–µ–ª (–∑–∞–≥–ª—É—à–∫–∞ 17)


## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ä–∞–∑–¥–µ–ª (–∑–∞–≥–ª—É—à–∫–∞ 18)


## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ä–∞–∑–¥–µ–ª (–∑–∞–≥–ª—É—à–∫–∞ 19)


## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ä–∞–∑–¥–µ–ª (–∑–∞–≥–ª—É—à–∫–∞ 20)


## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ä–∞–∑–¥–µ–ª (–∑–∞–≥–ª—É—à–∫–∞ 21)


## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ä–∞–∑–¥–µ–ª (–∑–∞–≥–ª—É—à–∫–∞ 22)


## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ä–∞–∑–¥–µ–ª (–∑–∞–≥–ª—É—à–∫–∞ 23)


## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ä–∞–∑–¥–µ–ª (–∑–∞–≥–ª—É—à–∫–∞ 24)


## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ä–∞–∑–¥–µ–ª (–∑–∞–≥–ª—É—à–∫–∞ 25)


## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ä–∞–∑–¥–µ–ª (–∑–∞–≥–ª—É—à–∫–∞ 26)


## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ä–∞–∑–¥–µ–ª (–∑–∞–≥–ª—É—à–∫–∞ 27)


## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ä–∞–∑–¥–µ–ª (–∑–∞–≥–ª—É—à–∫–∞ 28)


## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ä–∞–∑–¥–µ–ª (–∑–∞–≥–ª—É—à–∫–∞ 29)


## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ä–∞–∑–¥–µ–ª (–∑–∞–≥–ª—É—à–∫–∞ 30)


## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ä–∞–∑–¥–µ–ª (–∑–∞–≥–ª—É—à–∫–∞ 31)


## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ä–∞–∑–¥–µ–ª (–∑–∞–≥–ª—É—à–∫–∞ 32)


## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ä–∞–∑–¥–µ–ª (–∑–∞–≥–ª—É—à–∫–∞ 33)


## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ä–∞–∑–¥–µ–ª (–∑–∞–≥–ª—É—à–∫–∞ 34)


## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ä–∞–∑–¥–µ–ª (–∑–∞–≥–ª—É—à–∫–∞ 35)


## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ä–∞–∑–¥–µ–ª (–∑–∞–≥–ª—É—à–∫–∞ 36)


<!-- auto-added example blocks to match EN structure -->
```bash
echo "TODO: –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ –∏ –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–∏–º–µ—Ä"
```

```bash
echo "TODO: –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ –∏ –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–∏–º–µ—Ä"
```

```bash
echo "TODO: –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ –∏ –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–∏–º–µ—Ä"
```

```bash
echo "TODO: –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ –∏ –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–∏–º–µ—Ä"
```

```bash
echo "TODO: –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ –∏ –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–∏–º–µ—Ä"
```

```bash
echo "TODO: –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ –∏ –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–∏–º–µ—Ä"
```

```bash
echo "TODO: –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ –∏ –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–∏–º–µ—Ä"
```

```bash
echo "TODO: –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ –∏ –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–∏–º–µ—Ä"
```

```bash
echo "TODO: –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ –∏ –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–∏–º–µ—Ä"
```

```bash
echo "TODO: –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ –∏ –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–∏–º–µ—Ä"
```

```bash
echo "TODO: –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ –∏ –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–∏–º–µ—Ä"
```

```bash
echo "TODO: –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ –∏ –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–∏–º–µ—Ä"
```

```bash
echo "TODO: –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ –∏ –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–∏–º–µ—Ä"
```

```bash
echo "TODO: –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ –∏ –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–∏–º–µ—Ä"
```
